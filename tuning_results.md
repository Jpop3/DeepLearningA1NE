# Hyper-parameter Tuning Results
## Seed 0, Input Size 128

'input_size': 128, 'hidden_layers': [128, 64, 32, 10], 'activations': [None, 'ReLU', 'ReLU', 'softmax'], 'bn': True,  'lr': 0.001, 'epochs': 5, 'batch_size': 2
Epoch 5/5, Train loss: 1.64490, Val loss: 1.71292

Confusion matrix for train data:
[[1672.  220.  273.  122.   72.   68.   65.  305. 1028.  169.]
 [ 139. 1797.   83.  123.   42.   93.  123.  221.  469.  913.]
 [ 398.  160. 1373.  284.  375.  280.  372.  467.  163.  109.]
 [ 121.  168.  398. 1063.  153.  886.  429.  400.  165.  225.]
 [ 237.  155.  761.  191.  910.  273.  450.  758.  164.  107.]
 [  74.  137.  403.  620.  158. 1475.  320.  482.  171.  139.]
 [  44.  143.  544.  507.  306.  337. 1720.  230.   53.  137.]
 [ 117.  152.  226.  221.  279.  229.  143. 2282.  146.  219.]
 [ 386.  265.   66.   72.   35.  115.   20.   93. 2595.  294.]
 [ 180.  642.   59.  142.   12.   86.  113.  297.  620. 1902.]]

Confusion matrix for test data:
[[419.  43.  84.  27.   9.  12.  22.  71. 271.  42.]
 [ 33. 461.  30.  38.  15.  23.  25.  50. 118. 207.]
 [100.  41. 323.  89.  94.  69. 101. 107.  51.  25.]
 [ 32.  49. 104. 231.  45. 227. 106. 102.  33.  71.]
 [ 49.  40. 200.  47. 212.  82. 129. 182.  37.  22.]
 [ 21.  21. 121. 132.  50. 344.  90. 138.  54.  29.]
 [ 12.  39. 139. 121.  79.  80. 426.  53.  14.  37.]
 [ 40.  34.  44.  63.  66.  65.  41. 545.  45.  57.]
 [ 81.  73.  18.  21.   8.  35.   4.  36. 654.  70.]
 [ 42. 166.  14.  33.   8.  19.  33.  75. 158. 452.]]
Train accuracy: 0.419725, count: 16789 of 40000
Test accuracy: 0.4067, count: 4067 of 10000

#################################################################

SETUP = {
    'input_size': 128,
    'hidden_layers': [128, 128, 32, 10],
    'activations': [None, 'ReLU', 'ReLU', 'softmax'],
    'bn': True,
    'lr': 0.001,
    'epochs': 10,
    'batch_size': 2
}
Epoch 10/10, Train loss: 1.44802, Val loss: 1.58606

Confusion matrix for train data:
[[1991.  279.  191.   88.   89.   84.  127.  205.  686.  254.]
 [ 141. 2343.   64.   65.   60.   46.  135.  116.  303.  730.]
 [ 377.  111. 1172.  226.  360.  364.  719.  378.  172.  102.]
 [  84.  131.  308. 1045.  167.  880.  689.  324.  162.  218.]
 [ 218.   87.  460.  153. 1279.  227.  756.  538.  155.  133.]
 [  54.   85.  289.  507.  147. 1689.  539.  425.  136.  108.]
 [  27.   96.  258.  264.  261.  260. 2511.  155.   88.  101.]
 [ 157.   84.  165.  162.  279.  241.  194. 2422.   78.  232.]
 [ 345.  284.   57.   47.   58.   99.   43.   37. 2683.  288.]
 [ 150.  687.   55.   65.   36.   91.  129.  198.  294. 2348.]]

Confusion matrix for test data:
[[503.  55.  53.  17.  17.  21.  40.  40. 197.  57.]
 [ 23. 553.  19.  20.  19.  19.  33.  37.  94. 183.]
 [ 90.  26. 284.  72.  96.  91. 179.  95.  47.  20.]
 [ 27.  29.  90. 210.  43. 240. 169.  84.  33.  75.]
 [ 59.  19. 122.  36. 297.  58. 208. 137.  34.  30.]
 [ 17.  20.  82. 128.  50. 400. 135.  98.  44.  26.]
 [  6.  27.  69.  72.  63.  62. 617.  39.  14.  31.]
 [ 44.  30.  51.  40.  66.  73.  55. 543.  24.  74.]
 [ 94.  74.  13.  14.  15.  32.  15.  12. 656.  75.]
 [ 41. 174.  13.  23.   9.  26.  40.  58.  84. 532.]]
Train accuracy: 0.487075, count: 19483 of 40000
Test accuracy: 0.4595, count: 4595 of 10000

#################################################################

Setup: {'input_size': 128, 'hidden_layers': [128, 128, 64, 32, 10], 'activations': [None, 'ReLU', 'ReLU', 'ReLU', 'softmax'], 'bn': True, 'lr': 0.001, 'epochs': 10, 'batch_size': 2}
Epoch 10/10, Train loss: 1.41263, Val loss: 1.58975

Confusion matrix for train data:
[[2337.  235.  195.   75.  105.   36.   78.  118.  574.  241.]
 [ 168. 2593.   60.   71.   85.   20.   93.   71.  232.  610.]
 [ 485.  139. 1310.  398.  581.  149.  416.  250.  140.  113.]
 [ 189.  136.  390. 1586.  198.  409.  530.  206.  140.  224.]
 [ 287.  105.  634.  269. 1592.   90.  399.  348.  127.  155.]
 [ 120.  113.  466. 1080.  211. 1032.  419.  291.  101.  146.]
 [  89.  116.  368.  444.  485.  113. 2148.   92.   60.  106.]
 [ 204.  101.  241.  253.  452.  121.  151. 2109.   76.  306.]
 [ 495.  350.   56.   87.   56.   56.   38.   25. 2511.  267.]
 [ 187.  807.   43.   94.   43.   52.  117.  112.  276. 2322.]]

Confusion matrix for test data:
[[577.  51.  50.  26.  22.   6.  18.  28. 157.  65.]
 [ 36. 616.  20.  18.  13.  15.  26.  15.  64. 177.]
 [124.  32. 313. 110. 155.  35. 110.  59.  34.  28.]
 [ 49.  38. 107. 356.  53. 103. 132.  57.  33.  72.]
 [ 62.  21. 168.  83. 366.  25. 120.  87.  33.  35.]
 [ 32.  20. 120. 274.  55. 245.  93.  92.  35.  34.]
 [ 17.  28.  95. 118. 141.  26. 503.  25.  13.  34.]
 [ 53.  33.  49.  81.  95.  38.  48. 496.  13.  94.]
 [144.  98.  13.  27.  18.  14.  11.   6. 615.  54.]
 [ 47. 213.  11.  33.  12.  10.  37.  37.  93. 507.]]
Train accuracy: 0.4885, count: 19540 of 40000
Test accuracy: 0.4594, count: 4594 of 10000

#################################################################

Setup: {'input_size': 128, 'hidden_layers': [128, 128, 64, 32, 10], 'activations': [None, 'ReLU', 'ReLU', 'ReLU', 'softmax'], 'bn': False, 'lr': 0.01, 'epochs': 10, 'batch_size': 2}

Epoch 10/10, Train loss: 1.23464, Val loss: 1.54950

Confusion matrix for train data:
[[2389.  200.  126.   98.  199.   30.   61.  157.  453.  281.]
 [ 180. 2576.   37.   90.   81.   12.   64.   79.  171.  713.]
 [ 530.   81. 1012.  529. 1143.   69.  270.  185.   73.   89.]
 [ 173.   89.  290. 1993.  334.  238.  412.  210.  115.  154.]
 [ 305.   33.  408.  332. 2176.   38.  247.  278.   96.   93.]
 [ 101.   85.  416. 1584.  295.  751.  278.  301.   73.   95.]
 [  72.   76.  242.  518.  835.   50. 2039.   61.   43.   85.]
 [ 162.   58.  185.  390.  591.   94.   91. 2209.   40.  194.]
 [ 493.  299.   39.  112.   81.   27.   30.   46. 2449.  365.]
 [  98.  631.   32.  128.   54.   24.   87.  208.  171. 2620.]]

Confusion matrix for test data:
[[574.  41.  29.  29.  45.   7.  19.  31. 144.  81.]
 [ 36. 596.  13.  29.  15.   4.  24.  21.  53. 209.]
 [139.  17. 247. 150. 263.  17.  76.  58.  15.  18.]
 [ 57.  30.  91. 407.  96.  55. 118.  60.  29.  57.]
 [ 61.  15. 107.  80. 511.  10.  78.  85.  25.  28.]
 [ 39.   9. 107. 387.  79. 174.  73.  76.  26.  30.]
 [ 19.  22.  63. 116. 232.  10. 483.  20.  12.  23.]
 [ 56.  18.  40. 103. 142.  37.  40. 497.  11.  56.]
 [129.  80.   9.  27.  28.  15.  11.  24. 572. 105.]
 [ 36. 187.   8.  39.  15.   6.  25.  55.  59. 570.]]
Train accuracy: 0.50535, count: 20214 of 40000
Test accuracy: 0.4631, count: 4631 of 10000

#################################################################

SETUP = {
    'epochs': 100,
    'lr': 0.005,
    'bn': False,
    'batch_size': 2,
    'hidden_layers': [128, 64, 32, 10],
    'activations': [None, 'ReLU', 'ReLU', 'softmax'],
    'input_size': 128,
    'weight_decay': 0
}

Epoch 100/100, Train loss: 1.07471, Val loss: 1.57684
Potential OVERFITTING!! Had better val loss previous of 1.48 after 20 epochs

Confusion matrix for train data:
[[2524.  174.  205.  127.   97.   44.   58.   66.  580.  119.]
 [ 155. 3100.   15.  101.   20.   15.   55.   30.  285.  227.]
 [ 304.   57. 1959.  439.  400.  207.  312.  167.   77.   59.]
 [  89.   78.  318. 1860.  143.  723.  424.  160.  116.   97.]
 [ 232.   42.  695.  302. 1765.  158.  340.  308.  116.   48.]
 [  54.   52.  288. 1062.  145. 1713.  272.  256.   82.   55.]
 [  32.   66.  262.  357.  246.  196. 2681.   70.   55.   56.]
 [ 104.   70.  202.  356.  236.  233.   85. 2568.   46.  114.]
 [ 335.  216.   36.   85.   54.   40.   24.    9. 3065.   77.]
 [ 180.  929.   17.  204.   40.   36.   62.   88.  297. 2200.]]

Confusion matrix for test data:
[[565.  47.  54.  47.  30.  18.  20.  12. 167.  40.]
 [ 39. 659.  11.  39.  18.   6.  14.  20. 108.  86.]
 [ 89.  22. 392. 119. 102.  74. 106.  53.  24.  19.]
 [ 25.  37.  81. 370.  53. 177. 137.  58.  31.  31.]
 [ 68.  10. 192.  91. 325.  47. 141.  86.  29.  11.]
 [ 13.  13.  79. 266.  59. 341.  83.  85.  43.  18.]
 [ 13.  18.  93. 112.  74.  53. 576.  22.  20.  19.]
 [ 43.  31.  79. 107.  67.  72.  33. 507.  17.  44.]
 [108.  72.  11.  28.  16.  15.  12.   6. 691.  41.]
 [ 48. 258.  13.  68.  10.  16.  24.  33. 105. 425.]]

Train accuracy: 0.585875 (count 23435 of 40000)
Test accuracy: 0.4851 (count 4851 of 10000)


#################################################################
SETUP = {
    'epochs': 20,
    'lr': 0.005,
    'bn': False,
    'batch_size': 2,
    'hidden_layers': [128, 128, 64, 32, 10],
    'activations': [None, 'ReLU', 'ReLU', 'ReLU', 'softmax'],
    'input_size': 128,
    'weight_decay': 0
}

Epoch 20/20, Train loss: 1.06648, Val loss: 1.48511

Confusion matrix for train data:
[[2482.  221.  181.  149.   76.   43.   23.  143.  452.  224.]
 [ 121. 3083.   28.   61.   18.   15.   34.   47.  148.  448.]
 [ 355.  136. 1858.  295.  396.  270.  177.  311.   86.   97.]
 [  96.  125.  439. 1624.  102.  749.  243.  336.   87.  207.]
 [ 225.  111.  813.  240. 1561.  118.  196.  573.   84.   85.]
 [  44.   82.  405.  834.   93. 1733.  157.  460.   60.  111.]
 [  45.  117.  609.  405.  332.  152. 2101.  112.   33.  115.]
 [  88.   83.  148.  180.  129.  179.   48. 2951.   36.  172.]
 [ 402.  354.   45.   93.   48.   39.   15.   32. 2679.  234.]
 [ 106.  688.   43.   94.   14.   47.   30.  152.  133. 2746.]]

Confusion matrix for test data:
[[585.  57.  47.  35.  19.  16.  10.  41. 133.  57.]
 [ 44. 679.  14.  23.   4.   8.   8.  21.  58. 141.]
 [100.  32. 402.  91. 105.  68.  63.  94.  15.  30.]
 [ 33.  34. 118. 296.  33. 203.  74. 111.  23.  75.]
 [ 65.  29. 232.  69. 311.  31.  77. 148.  18.  20.]
 [ 24.  24. 101. 207.  34. 372.  46. 135.  26.  31.]
 [  9.  38. 172. 128. 108.  42. 427.  32.  13.  31.]
 [ 37.  27.  45.  59.  51.  58.  21. 633.   9.  60.]
 [126. 109.  10.  33.  10.  23.   6.  20. 598.  65.]
 [ 42. 209.   8.  40.   4.  17.  10.  60.  50. 560.]]
Train accuracy: 0.57045 (count 22818 of 40000)
Test accuracy: 0.4863 (count 4863 of 10000)

#################################################################

Epoch 20/20, Train loss: 1.39285, Val loss: 1.63460
Setup: {'epochs': 20, 'lr': 0.001, 'bn': False, 'batch_size': 2, 'hidden_layers': [128, 64, 32, 10], 'activations': [None, 'ReLU', 'ReLU', 'softmax'], 'input_size': 128, 'weight_decay': 0, 'optimiser': 'Adam'}

Confusion matrix for train data:
[[2311.  179.  156.  125.  183.   83.   53.   88.  582.  234.]
 [ 198. 2441.   36.   79.   39.   62.   89.   71.  270.  718.]
 [ 381.   62. 1167.  433.  844.  406.  317.  185.  112.   74.]
 [ 122.   74.  232. 1541.  216. 1089.  356.  165.  106.  107.]
 [ 273.   60.  410.  245. 1939.  273.  299.  321.  101.   85.]
 [  75.   44.  238. 1058.  207. 1780.  226.  204.   81.   66.]
 [  41.   69.  238.  553.  638.  269. 2044.   71.   48.   50.]
 [ 151.   65.  172.  278.  418.  486.   75. 2161.   44.  164.]
 [ 530.  252.   44.  133.   73.  104.   35.   18. 2539.  213.]
 [ 190.  583.   27.  173.   34.   91.   93.  135.  269. 2458.]]

Confusion matrix for test data:
[[544.  40.  52.  33.  38.  26.  23.  23. 156.  65.]
 [ 53. 546.  17.  37.  17.  22.  19.  16.  82. 191.]
 [101.  21. 249. 129. 206.  98.  86.  52.  35.  23.]
 [ 45.  26.  56. 307.  60. 263. 101.  68.  33.  41.]
 [ 71.  16.  98.  69. 440.  71.  96.  98.  24.  17.]
 [ 24.  11.  55. 277.  61. 396.  65.  74.  21.  16.]
 [ 15.  23.  71. 149. 173.  74. 435.  32.   9.  19.]
 [ 39.  17.  60.  98. 117. 114.  29. 454.  12.  60.]
 [147.  74.   7.  36.  25.  30.  11.   7. 592.  71.]
 [ 54. 159.   8.  48.  14.  36.  23.  44.  77. 537.]]
Train accuracy: 0.509525 (count 20381 of 40000)
Test accuracy: 0.45 (count 4500 of 10000)


#################################################################

Epoch 20/20, Train loss: 1.28835, Val loss: 1.47224
Setup: {'epochs': 20, 'lr': 0.001, 'bn': False, 'batch_size': 2, 'hidden_layers': [128, 64, 32, 10], 'activations': [None, 'ReLU', 'ReLU', 'softmax'], 'input_size': 128, 'weight_decay': 0, 'optimiser': None}

Confusion matrix for train data:
[[2410.  208.  122.  171.  149.   64.   55.  121.  496.  198.]
 [ 183. 2700.   38.  129.   51.   44.   50.   70.  191.  547.]
 [ 396.   89. 1035.  528.  891.  317.  316.  237.   95.   77.]
 [ 162.  104.  210. 1878.  206.  739.  306.  199.   92.  112.]
 [ 249.   64.  322.  374. 1994.  216.  285.  346.   90.   66.]
 [  86.   85.  217. 1158.  239. 1623.  187.  253.   63.   68.]
 [  61.   78.  251.  637.  581.  248. 1973.   80.   47.   65.]
 [ 165.   90.  108.  353.  425.  275.   56. 2331.   49.  162.]
 [ 464.  297.   41.  142.   62.   80.   25.   28. 2576.  226.]
 [ 210.  775.   35.  205.   35.   95.   55.  173.  172. 2298.]]

Confusion matrix for test data:
[[608.  40.  39.  40.  39.  19.  11.  21. 125.  58.]
 [ 55. 610.   8.  41.  10.  23.  16.  21.  63. 153.]
 [105.  28. 245. 153. 217.  78.  79.  58.  20.  17.]
 [ 44.  22.  48. 430.  58. 179.  89.  56.  25.  49.]
 [ 58.  13.  92. 112. 443.  56.  96.  85.  27.  18.]
 [ 28.  17.  61. 276.  70. 366.  57.  81.  24.  20.]
 [ 10.  31.  60. 149. 156.  66. 471.  25.  15.  17.]
 [ 61.  23.  26. 101. 113.  86.  23. 502.  12.  53.]
 [123.  87.  10.  48.  12.  26.   2.  16. 604.  72.]
 [ 64. 192.   8.  64.  13.  20.  16.  56.  61. 506.]]
Train accuracy: 0.52045 (count 20818 of 40000)
Test accuracy: 0.4785 (count 4785 of 10000)


#################################################################

Epoch 20/20, Train loss: 1.35136, Val loss: 1.49158

Setup: {'epochs': 20, 'lr': 0.0001, 'bn': False, 'batch_size': 2, 'hidden_layers': [128, 64, 32, 10], 'activations': [None, 'ReLU', 'ReLU', 'softmax'], 'input_size': 128, 'weight_decay': 0, 'optimiser': 'Adam'}

Confusion matrix for train data:
[[2411.  175.  202.  149.  148.   51.   48.  151.  470.  189.]
 [ 187. 2577.   56.  114.   71.   39.   70.   80.  241.  568.]
 [ 325.   87. 1451.  455.  671.  272.  327.  243.   94.   56.]
 [ 118.   78.  280. 1839.  256.  617.  387.  232.  102.   99.]
 [ 231.   84.  445.  320. 1856.  191.  319.  403.   99.   58.]
 [  69.   55.  268. 1133.  280. 1496.  238.  317.   67.   56.]
 [  55.   92.  279.  575.  495.  193. 2117.  102.   43.   70.]
 [ 146.   71.  174.  304.  462.  209.   86. 2382.   58.  122.]
 [ 420.  226.   55.  135.   76.   88.   27.   33. 2683.  198.]
 [ 198.  621.   58.  191.   45.   75.   66.  216.  250. 2333.]]

Confusion matrix for test data:
[[573.  37.  60.  31.  30.  12.  20.  32. 151.  54.]
 [ 51. 572.  25.  42.  19.  13.  22.  25.  74. 157.]
 [ 90.  23. 325. 139. 162.  66.  83.  76.  19.  17.]
 [ 38.  26.  71. 402.  69. 165.  97.  64.  25.  43.]
 [ 52.  15. 120.  91. 403.  50. 112. 120.  24.  13.]
 [ 25.  18.  73. 258.  87. 346.  59.  93.  24.  17.]
 [ 14.  28.  72. 138. 141.  41. 505.  24.  18.  19.]
 [ 37.  26.  44. 104. 115.  62.  27. 536.  16.  33.]
 [103.  74.  14.  44.  19.  20.   6.  15. 638.  67.]
 [ 60. 179.  24.  44.  15.  23.  18.  59.  62. 516.]]
Train accuracy: 0.528625 (count 21145 of 40000)
Test accuracy: 0.4816 (count 4816 of 10000)



Key observations -
Adams optimisers likes a much lower learning rate (0.0001) !! - Need to also check with seb that it is implemented correctly, ends up getting a good validation loss. Needed to have the optimiser made for each hidden layer.