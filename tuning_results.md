# Hyper-parameter Tuning Results
## Seed 0, Input Size 128

'input_size': 128, 'hidden_layers': [128, 64, 32, 10], 'activations': [None, 'ReLU', 'ReLU', 'softmax'], 'bn': True,  'lr': 0.001, 'epochs': 5, 'batch_size': 2
Epoch 5/5, Train loss: 1.64490, Val loss: 1.71292

Confusion matrix for train data:
[[1672.  220.  273.  122.   72.   68.   65.  305. 1028.  169.]
 [ 139. 1797.   83.  123.   42.   93.  123.  221.  469.  913.]
 [ 398.  160. 1373.  284.  375.  280.  372.  467.  163.  109.]
 [ 121.  168.  398. 1063.  153.  886.  429.  400.  165.  225.]
 [ 237.  155.  761.  191.  910.  273.  450.  758.  164.  107.]
 [  74.  137.  403.  620.  158. 1475.  320.  482.  171.  139.]
 [  44.  143.  544.  507.  306.  337. 1720.  230.   53.  137.]
 [ 117.  152.  226.  221.  279.  229.  143. 2282.  146.  219.]
 [ 386.  265.   66.   72.   35.  115.   20.   93. 2595.  294.]
 [ 180.  642.   59.  142.   12.   86.  113.  297.  620. 1902.]]

Confusion matrix for test data:
[[419.  43.  84.  27.   9.  12.  22.  71. 271.  42.]
 [ 33. 461.  30.  38.  15.  23.  25.  50. 118. 207.]
 [100.  41. 323.  89.  94.  69. 101. 107.  51.  25.]
 [ 32.  49. 104. 231.  45. 227. 106. 102.  33.  71.]
 [ 49.  40. 200.  47. 212.  82. 129. 182.  37.  22.]
 [ 21.  21. 121. 132.  50. 344.  90. 138.  54.  29.]
 [ 12.  39. 139. 121.  79.  80. 426.  53.  14.  37.]
 [ 40.  34.  44.  63.  66.  65.  41. 545.  45.  57.]
 [ 81.  73.  18.  21.   8.  35.   4.  36. 654.  70.]
 [ 42. 166.  14.  33.   8.  19.  33.  75. 158. 452.]]
Train accuracy: 0.419725, count: 16789 of 40000
Test accuracy: 0.4067, count: 4067 of 10000

#################################################################

SETUP = {
    'input_size': 128,
    'hidden_layers': [128, 128, 32, 10],
    'activations': [None, 'ReLU', 'ReLU', 'softmax'],
    'bn': True,
    'lr': 0.001,
    'epochs': 10,
    'batch_size': 2
}
Epoch 10/10, Train loss: 1.44802, Val loss: 1.58606

Confusion matrix for train data:
[[1991.  279.  191.   88.   89.   84.  127.  205.  686.  254.]
 [ 141. 2343.   64.   65.   60.   46.  135.  116.  303.  730.]
 [ 377.  111. 1172.  226.  360.  364.  719.  378.  172.  102.]
 [  84.  131.  308. 1045.  167.  880.  689.  324.  162.  218.]
 [ 218.   87.  460.  153. 1279.  227.  756.  538.  155.  133.]
 [  54.   85.  289.  507.  147. 1689.  539.  425.  136.  108.]
 [  27.   96.  258.  264.  261.  260. 2511.  155.   88.  101.]
 [ 157.   84.  165.  162.  279.  241.  194. 2422.   78.  232.]
 [ 345.  284.   57.   47.   58.   99.   43.   37. 2683.  288.]
 [ 150.  687.   55.   65.   36.   91.  129.  198.  294. 2348.]]

Confusion matrix for test data:
[[503.  55.  53.  17.  17.  21.  40.  40. 197.  57.]
 [ 23. 553.  19.  20.  19.  19.  33.  37.  94. 183.]
 [ 90.  26. 284.  72.  96.  91. 179.  95.  47.  20.]
 [ 27.  29.  90. 210.  43. 240. 169.  84.  33.  75.]
 [ 59.  19. 122.  36. 297.  58. 208. 137.  34.  30.]
 [ 17.  20.  82. 128.  50. 400. 135.  98.  44.  26.]
 [  6.  27.  69.  72.  63.  62. 617.  39.  14.  31.]
 [ 44.  30.  51.  40.  66.  73.  55. 543.  24.  74.]
 [ 94.  74.  13.  14.  15.  32.  15.  12. 656.  75.]
 [ 41. 174.  13.  23.   9.  26.  40.  58.  84. 532.]]
Train accuracy: 0.487075, count: 19483 of 40000
Test accuracy: 0.4595, count: 4595 of 10000

#################################################################

Setup: {'input_size': 128, 'hidden_layers': [128, 128, 64, 32, 10], 'activations': [None, 'ReLU', 'ReLU', 'ReLU', 'softmax'], 'bn': True, 'lr': 0.001, 'epochs': 10, 'batch_size': 2}
Epoch 10/10, Train loss: 1.41263, Val loss: 1.58975

Confusion matrix for train data:
[[2337.  235.  195.   75.  105.   36.   78.  118.  574.  241.]
 [ 168. 2593.   60.   71.   85.   20.   93.   71.  232.  610.]
 [ 485.  139. 1310.  398.  581.  149.  416.  250.  140.  113.]
 [ 189.  136.  390. 1586.  198.  409.  530.  206.  140.  224.]
 [ 287.  105.  634.  269. 1592.   90.  399.  348.  127.  155.]
 [ 120.  113.  466. 1080.  211. 1032.  419.  291.  101.  146.]
 [  89.  116.  368.  444.  485.  113. 2148.   92.   60.  106.]
 [ 204.  101.  241.  253.  452.  121.  151. 2109.   76.  306.]
 [ 495.  350.   56.   87.   56.   56.   38.   25. 2511.  267.]
 [ 187.  807.   43.   94.   43.   52.  117.  112.  276. 2322.]]

Confusion matrix for test data:
[[577.  51.  50.  26.  22.   6.  18.  28. 157.  65.]
 [ 36. 616.  20.  18.  13.  15.  26.  15.  64. 177.]
 [124.  32. 313. 110. 155.  35. 110.  59.  34.  28.]
 [ 49.  38. 107. 356.  53. 103. 132.  57.  33.  72.]
 [ 62.  21. 168.  83. 366.  25. 120.  87.  33.  35.]
 [ 32.  20. 120. 274.  55. 245.  93.  92.  35.  34.]
 [ 17.  28.  95. 118. 141.  26. 503.  25.  13.  34.]
 [ 53.  33.  49.  81.  95.  38.  48. 496.  13.  94.]
 [144.  98.  13.  27.  18.  14.  11.   6. 615.  54.]
 [ 47. 213.  11.  33.  12.  10.  37.  37.  93. 507.]]
Train accuracy: 0.4885, count: 19540 of 40000
Test accuracy: 0.4594, count: 4594 of 10000

#################################################################

Setup: {'input_size': 128, 'hidden_layers': [128, 128, 64, 32, 10], 'activations': [None, 'ReLU', 'ReLU', 'ReLU', 'softmax'], 'bn': False, 'lr': 0.01, 'epochs': 10, 'batch_size': 2}

Epoch 10/10, Train loss: 1.23464, Val loss: 1.54950

Confusion matrix for train data:
[[2389.  200.  126.   98.  199.   30.   61.  157.  453.  281.]
 [ 180. 2576.   37.   90.   81.   12.   64.   79.  171.  713.]
 [ 530.   81. 1012.  529. 1143.   69.  270.  185.   73.   89.]
 [ 173.   89.  290. 1993.  334.  238.  412.  210.  115.  154.]
 [ 305.   33.  408.  332. 2176.   38.  247.  278.   96.   93.]
 [ 101.   85.  416. 1584.  295.  751.  278.  301.   73.   95.]
 [  72.   76.  242.  518.  835.   50. 2039.   61.   43.   85.]
 [ 162.   58.  185.  390.  591.   94.   91. 2209.   40.  194.]
 [ 493.  299.   39.  112.   81.   27.   30.   46. 2449.  365.]
 [  98.  631.   32.  128.   54.   24.   87.  208.  171. 2620.]]

Confusion matrix for test data:
[[574.  41.  29.  29.  45.   7.  19.  31. 144.  81.]
 [ 36. 596.  13.  29.  15.   4.  24.  21.  53. 209.]
 [139.  17. 247. 150. 263.  17.  76.  58.  15.  18.]
 [ 57.  30.  91. 407.  96.  55. 118.  60.  29.  57.]
 [ 61.  15. 107.  80. 511.  10.  78.  85.  25.  28.]
 [ 39.   9. 107. 387.  79. 174.  73.  76.  26.  30.]
 [ 19.  22.  63. 116. 232.  10. 483.  20.  12.  23.]
 [ 56.  18.  40. 103. 142.  37.  40. 497.  11.  56.]
 [129.  80.   9.  27.  28.  15.  11.  24. 572. 105.]
 [ 36. 187.   8.  39.  15.   6.  25.  55.  59. 570.]]
Train accuracy: 0.50535, count: 20214 of 40000
Test accuracy: 0.4631, count: 4631 of 10000

#################################################################

SETUP = {
    'epochs': 100,
    'lr': 0.005,
    'bn': False,
    'batch_size': 2,
    'hidden_layers': [128, 64, 32, 10],
    'activations': [None, 'ReLU', 'ReLU', 'softmax'],
    'input_size': 128,
    'weight_decay': 0
}

Epoch 100/100, Train loss: 1.07471, Val loss: 1.57684
Potential OVERFITTING!! Had better val loss previous of 1.48 after 20 epochs

Confusion matrix for train data:
[[2524.  174.  205.  127.   97.   44.   58.   66.  580.  119.]
 [ 155. 3100.   15.  101.   20.   15.   55.   30.  285.  227.]
 [ 304.   57. 1959.  439.  400.  207.  312.  167.   77.   59.]
 [  89.   78.  318. 1860.  143.  723.  424.  160.  116.   97.]
 [ 232.   42.  695.  302. 1765.  158.  340.  308.  116.   48.]
 [  54.   52.  288. 1062.  145. 1713.  272.  256.   82.   55.]
 [  32.   66.  262.  357.  246.  196. 2681.   70.   55.   56.]
 [ 104.   70.  202.  356.  236.  233.   85. 2568.   46.  114.]
 [ 335.  216.   36.   85.   54.   40.   24.    9. 3065.   77.]
 [ 180.  929.   17.  204.   40.   36.   62.   88.  297. 2200.]]

Confusion matrix for test data:
[[565.  47.  54.  47.  30.  18.  20.  12. 167.  40.]
 [ 39. 659.  11.  39.  18.   6.  14.  20. 108.  86.]
 [ 89.  22. 392. 119. 102.  74. 106.  53.  24.  19.]
 [ 25.  37.  81. 370.  53. 177. 137.  58.  31.  31.]
 [ 68.  10. 192.  91. 325.  47. 141.  86.  29.  11.]
 [ 13.  13.  79. 266.  59. 341.  83.  85.  43.  18.]
 [ 13.  18.  93. 112.  74.  53. 576.  22.  20.  19.]
 [ 43.  31.  79. 107.  67.  72.  33. 507.  17.  44.]
 [108.  72.  11.  28.  16.  15.  12.   6. 691.  41.]
 [ 48. 258.  13.  68.  10.  16.  24.  33. 105. 425.]]

Train accuracy: 0.585875 (count 23435 of 40000)
Test accuracy: 0.4851 (count 4851 of 10000)


#################################################################
SETUP = {
    'epochs': 20,
    'lr': 0.005,
    'bn': False,
    'batch_size': 2,
    'hidden_layers': [128, 128, 64, 32, 10],
    'activations': [None, 'ReLU', 'ReLU', 'ReLU', 'softmax'],
    'input_size': 128,
    'weight_decay': 0
}

Epoch 20/20, Train loss: 1.06648, Val loss: 1.48511

Confusion matrix for train data:
[[2482.  221.  181.  149.   76.   43.   23.  143.  452.  224.]
 [ 121. 3083.   28.   61.   18.   15.   34.   47.  148.  448.]
 [ 355.  136. 1858.  295.  396.  270.  177.  311.   86.   97.]
 [  96.  125.  439. 1624.  102.  749.  243.  336.   87.  207.]
 [ 225.  111.  813.  240. 1561.  118.  196.  573.   84.   85.]
 [  44.   82.  405.  834.   93. 1733.  157.  460.   60.  111.]
 [  45.  117.  609.  405.  332.  152. 2101.  112.   33.  115.]
 [  88.   83.  148.  180.  129.  179.   48. 2951.   36.  172.]
 [ 402.  354.   45.   93.   48.   39.   15.   32. 2679.  234.]
 [ 106.  688.   43.   94.   14.   47.   30.  152.  133. 2746.]]

Confusion matrix for test data:
[[585.  57.  47.  35.  19.  16.  10.  41. 133.  57.]
 [ 44. 679.  14.  23.   4.   8.   8.  21.  58. 141.]
 [100.  32. 402.  91. 105.  68.  63.  94.  15.  30.]
 [ 33.  34. 118. 296.  33. 203.  74. 111.  23.  75.]
 [ 65.  29. 232.  69. 311.  31.  77. 148.  18.  20.]
 [ 24.  24. 101. 207.  34. 372.  46. 135.  26.  31.]
 [  9.  38. 172. 128. 108.  42. 427.  32.  13.  31.]
 [ 37.  27.  45.  59.  51.  58.  21. 633.   9.  60.]
 [126. 109.  10.  33.  10.  23.   6.  20. 598.  65.]
 [ 42. 209.   8.  40.   4.  17.  10.  60.  50. 560.]]
Train accuracy: 0.57045 (count 22818 of 40000)
Test accuracy: 0.4863 (count 4863 of 10000)

#################################################################

Epoch 20/20, Train loss: 1.38274, Val loss: 1.50651
Setup: {'epochs': 20, 'lr': 0.001, 'bn': False, 'batch_size': 2, 'hidden_layers': [128, 64, 32, 10], 'activations': [None, 'ReLU', 'ReLU', 'softmax'], 'input_size': 128, 'weight_decay': 0, 'optimiser': 'Adam'}

Confusion matrix for train data:
[[2414.  188.  124.  249.  124.   49.   30.  111.  473.  232.]
 [ 196. 2593.   19.  190.   26.   30.   37.   46.  198.  668.]
 [ 368.  113. 1167.  570.  865.  280.  220.  204.  100.   94.]
 [ 123.  117.  192. 2035.  174.  710.  281.  162.   91.  123.]
 [ 264.   79.  348.  409. 1919.  253.  224.  310.  107.   93.]
 [  83.   89.  217. 1351.  217. 1508.  177.  189.   72.   76.]
 [  51.  109.  163.  770.  686.  244. 1817.   71.   45.   65.]
 [ 142.  112.  131.  498.  323.  358.   52. 2131.   47.  220.]
 [ 614.  282.   26.  196.   50.   79.   11.   16. 2423.  244.]
 [ 185.  704.   17.  299.   30.   54.   36.  120.  204. 2404.]]

Confusion matrix for test data:
[[579.  38.  43.  55.  24.  11.  11.  37. 147.  55.]
 [ 58. 616.   8.  50.   7.   9.  13.  13.  58. 168.]
 [ 96.  35. 263. 160. 202.  76.  67.  54.  25.  22.]
 [ 33.  37.  51. 453.  54. 184.  77.  32.  29.  50.]
 [ 56.  20.  93. 116. 452.  60.  70.  84.  30.  19.]
 [ 28.  22.  45. 331.  65. 351.  49.  59.  26.  24.]
 [  8.  36.  44. 184. 183.  60. 435.  16.  17.  17.]
 [ 49.  36.  31. 138.  86. 102.  20. 449.  16.  73.]
 [146.  81.   5.  46.  13.  32.   4.  10. 594.  69.]
 [ 47. 208.   2.  83.   4.  16.  17.  38.  60. 525.]]
Train accuracy: 0.510275 (count 20411 of 40000)
Test accuracy: 0.4717 (count 4717 of 10000)


#################################################################

Epoch 1/20, Train loss: 1.93432, Val loss: 1.82086
Epoch 2/20, Train loss: 1.70302, Val loss: 1.72037
Epoch 3/20, Train loss: 1.64344, Val loss: 1.68561
Epoch 4/20, Train loss: 1.61476, Val loss: 1.66674
Epoch 5/20, Train loss: 1.57714, Val loss: 1.65641
Epoch 6/20, Train loss: 1.55716, Val loss: 1.62094
Epoch 7/20, Train loss: 1.53940, Val loss: 1.62037
Epoch 8/20, Train loss: 1.52759, Val loss: 1.60993
Epoch 9/20, Train loss: 1.51913, Val loss: 1.60082
Epoch 10/20, Train loss: 1.50305, Val loss: 1.58555
Epoch 11/20, Train loss: 1.48963, Val loss: 1.59491
Epoch 12/20, Train loss: 1.47483, Val loss: 1.57593
Epoch 13/20, Train loss: 1.47870, Val loss: 1.57817
Epoch 14/20, Train loss: 1.46806, Val loss: 1.56019
Epoch 15/20, Train loss: 1.45192, Val loss: 1.54982
Epoch 16/20, Train loss: 1.45942, Val loss: 1.54582
Epoch 17/20, Train loss: 1.43825, Val loss: 1.52934
Epoch 18/20, Train loss: 1.43471, Val loss: 1.54129
Epoch 19/20, Train loss: 1.42815, Val loss: 1.53717
Epoch 20/20, Train loss: 1.43302, Val loss: 1.52772
Setup: {'epochs': 20, 'lr': 0.002, 'bn': False, 'batch_size': 2, 'hidden_layers': [128, 64, 32, 10], 'activations': [None, 'ReLU', 'ReLU', 'softmax'], 'input_size': 128, 'weight_decay': 0, 'optimiser': None}

Confusion matrix for train data:
[[2156.  251.  164.  270.  189.   51.   31.  117.  577.  188.]
 [ 176. 2500.   38.  205.   97.   42.   50.   70.  257.  568.]
 [ 394.  141.  915.  624. 1096.  197.  229.  210.  109.   66.]
 [ 107.  131.  243. 2088.  277.  504.  251.  162.  130.  115.]
 [ 259.   69.  347.  460. 1986.  148.  248.  329.   98.   62.]
 [  82.  124.  229. 1504.  292. 1215.  176.  200.   94.   63.]
 [  38.   86.  252.  930.  851.  187. 1501.   83.   39.   54.]
 [ 173.  147.  114.  484.  626.  236.   48. 1940.   54.  192.]
 [ 501.  332.   30.  197.  103.   74.   11.   34. 2422.  237.]
 [ 240.  798.   26.  273.   64.   69.   56.  182.  274. 2071.]]

Confusion matrix for test data:
[[555.  43.  51.  63.  38.   5.  12.  34. 157.  42.]
 [ 49. 623.  12.  47.  18.  16.  16.  14.  68. 137.]
 [109.  37. 237. 183. 244.  52.  58.  50.  21.   9.]
 [ 30.  36.  65. 515.  72. 122.  61.  45.  23.  31.]
 [ 52.  15.  87. 119. 496.  35.  76.  78.  28.  14.]
 [ 26.  20.  71. 355.  84. 306.  43.  52.  29.  14.]
 [ 12.  29.  59. 225. 220.  50. 357.  20.  10.  18.]
 [ 47.  41.  34. 131. 145.  68.  15. 459.  16.  44.]
 [114.  94.   3.  60.  28.  18.   3.  11. 609.  60.]
 [ 45. 218.  10.  70.  16.  12.  19.  46.  77. 487.]]
Train accuracy: 0.46985 (count 18794 of 40000)
Test accuracy: 0.4644 (count 4644 of 10000)

#################################################################

Epoch 1/20, Train loss: 2.06133, Val loss: 1.90627
Epoch 2/20, Train loss: 1.81248, Val loss: 1.79390
Epoch 3/20, Train loss: 1.74425, Val loss: 1.75990
Epoch 4/20, Train loss: 1.72248, Val loss: 1.73990
Epoch 5/20, Train loss: 1.69418, Val loss: 1.72787
Epoch 6/20, Train loss: 1.68280, Val loss: 1.71078
Epoch 7/20, Train loss: 1.66833, Val loss: 1.70533
Epoch 8/20, Train loss: 1.66182, Val loss: 1.69590
Epoch 9/20, Train loss: 1.65685, Val loss: 1.69197
Epoch 10/20, Train loss: 1.64860, Val loss: 1.68310
Epoch 11/20, Train loss: 1.64015, Val loss: 1.69264
Epoch 12/20, Train loss: 1.63185, Val loss: 1.67748
Epoch 13/20, Train loss: 1.63192, Val loss: 1.67768
Epoch 14/20, Train loss: 1.62026, Val loss: 1.66856
Epoch 15/20, Train loss: 1.61562, Val loss: 1.66187
Epoch 16/20, Train loss: 1.62578, Val loss: 1.65799
Epoch 17/20, Train loss: 1.61132, Val loss: 1.65247
Epoch 18/20, Train loss: 1.60660, Val loss: 1.65369
Epoch 19/20, Train loss: 1.59938, Val loss: 1.65065
Epoch 20/20, Train loss: 1.60226, Val loss: 1.64728
Setup: {'epochs': 20, 'lr': 0.001, 'bn': False, 'batch_size': 2, 'hidden_layers': [128, 64, 32, 10], 'activations': [None, 'ReLU', 'ReLU', 'softmax'], 'input_size': 128, 'weight_decay': 0, 'optimiser': None}

Confusion matrix for train data:
[[1927.  299.  126.  266.  156.   36.   47.  183.  748.  206.]
 [ 178. 2295.   26.  208.  100.   25.   84.  105.  290.  692.]
 [ 498.  211.  777.  602.  990.  127.  349.  257.  107.   63.]
 [ 146.  230.  229. 1863.  279.  458.  340.  195.  131.  137.]
 [ 326.  154.  366.  433. 1675.  134.  373.  392.   87.   66.]
 [  91.  180.  216. 1464.  361.  995.  263.  226.  113.   70.]
 [  40.  145.  244.  991.  791.  122. 1494.   86.   33.   75.]
 [ 193.  221.  115.  475.  766.  171.   89. 1685.   93.  206.]
 [ 530.  359.   37.  190.   60.   84.   18.   39. 2261.  363.]
 [ 225.  890.   23.  249.   60.   47.   89.  217.  398. 1855.]]

Confusion matrix for test data:
[[498.  59.  34.  67.  28.   2.  16.  44. 207.  45.]
 [ 55. 579.   3.  57.  24.   8.  20.  24.  70. 160.]
 [127.  50. 186. 171. 238.  29.  99.  58.  30.  12.]
 [ 36.  57.  54. 466.  78. 111.  75.  59.  27.  37.]
 [ 67.  33.  90. 109. 429.  33. 109.  86.  26.  18.]
 [ 35.  36.  70. 305.  95. 265.  60.  78.  39.  17.]
 [ 11.  38.  60. 258. 201.  26. 362.  14.   8.  22.]
 [ 48.  64.  30. 118. 166.  41.  31. 418.  30.  54.]
 [122.  93.   2.  61.  18.  15.   4.  18. 586.  81.]
 [ 48. 221.   5.  58.  14.   8.  21.  58. 105. 462.]]
Train accuracy: 0.420675 (count 16827 of 40000)
Test accuracy: 0.4251 (count 4251 of 10000)

#################################################################

Epoch 20/20, Train loss: 1.35136, Val loss: 1.49158

Setup: {'epochs': 20, 'lr': 0.0001, 'bn': False, 'batch_size': 2, 'hidden_layers': [128, 64, 32, 10], 'activations': [None, 'ReLU', 'ReLU', 'softmax'], 'input_size': 128, 'weight_decay': 0, 'optimiser': 'Adam'}

Confusion matrix for train data:
[[2411.  175.  202.  149.  148.   51.   48.  151.  470.  189.]
 [ 187. 2577.   56.  114.   71.   39.   70.   80.  241.  568.]
 [ 325.   87. 1451.  455.  671.  272.  327.  243.   94.   56.]
 [ 118.   78.  280. 1839.  256.  617.  387.  232.  102.   99.]
 [ 231.   84.  445.  320. 1856.  191.  319.  403.   99.   58.]
 [  69.   55.  268. 1133.  280. 1496.  238.  317.   67.   56.]
 [  55.   92.  279.  575.  495.  193. 2117.  102.   43.   70.]
 [ 146.   71.  174.  304.  462.  209.   86. 2382.   58.  122.]
 [ 420.  226.   55.  135.   76.   88.   27.   33. 2683.  198.]
 [ 198.  621.   58.  191.   45.   75.   66.  216.  250. 2333.]]

Confusion matrix for test data:
[[573.  37.  60.  31.  30.  12.  20.  32. 151.  54.]
 [ 51. 572.  25.  42.  19.  13.  22.  25.  74. 157.]
 [ 90.  23. 325. 139. 162.  66.  83.  76.  19.  17.]
 [ 38.  26.  71. 402.  69. 165.  97.  64.  25.  43.]
 [ 52.  15. 120.  91. 403.  50. 112. 120.  24.  13.]
 [ 25.  18.  73. 258.  87. 346.  59.  93.  24.  17.]
 [ 14.  28.  72. 138. 141.  41. 505.  24.  18.  19.]
 [ 37.  26.  44. 104. 115.  62.  27. 536.  16.  33.]
 [103.  74.  14.  44.  19.  20.   6.  15. 638.  67.]
 [ 60. 179.  24.  44.  15.  23.  18.  59.  62. 516.]]
Train accuracy: 0.528625 (count 21145 of 40000)
Test accuracy: 0.4816 (count 4816 of 10000)

#################################################################

Epoch 1/10, Train loss: 2.08747, Val loss: 1.88882
Epoch 2/10, Train loss: 1.78845, Val loss: 1.75701
Epoch 3/10, Train loss: 1.69366, Val loss: 1.69722
Epoch 4/10, Train loss: 1.64383, Val loss: 1.65946
Epoch 5/10, Train loss: 1.59025, Val loss: 1.62957
Epoch 6/10, Train loss: 1.55687, Val loss: 1.60902
Epoch 7/10, Train loss: 1.53110, Val loss: 1.59301
Epoch 8/10, Train loss: 1.51057, Val loss: 1.57496
Epoch 9/10, Train loss: 1.49388, Val loss: 1.55840
Epoch 10/10, Train loss: 1.47463, Val loss: 1.54867
Setup: {'epochs': 10, 'lr': 0.0001, 'bn': False, 'batch_size': 2, 'hidden_layers': [128, 64, 32, 10], 'activations': [None, 'ReLU', 'ReLU', 'softmax'], 'input_size': 128, 'weight_decay': 0, 'optimiser': 'Adam'}

Confusion matrix for train data:
[[2157.  175.  171.  146.  120.   70.   69.  192.  640.  254.]
 [ 151. 2232.   46.   98.   93.   61.  102.  142.  317.  761.]
 [ 360.  122. 1229.  334.  613.  339.  465.  300.  117.  102.]
 [ 136.  102.  238. 1455.  276.  723.  482.  250.  149.  197.]
 [ 246.   80.  459.  256. 1607.  236.  436.  468.  126.   92.]
 [  70.   83.  245.  892.  293. 1488.  342.  345.  120.  101.]
 [  53.   82.  266.  465.  487.  228. 2154.  128.   46.  112.]
 [ 136.   76.  162.  234.  461.  285.  125. 2253.   76.  206.]
 [ 417.  189.   49.  101.  104.   68.   33.   38. 2646.  296.]
 [ 195.  581.   35.  108.   40.   89.   94.  199.  315. 2397.]]

Confusion matrix for test data:
[[549.  40.  48.  35.  19.  14.  27.  39. 166.  63.]
 [ 37. 534.   8.  29.  28.  21.  21.  36.  94. 192.]
 [ 86.  31. 283. 110. 151.  84. 122.  79.  31.  23.]
 [ 34.  34.  62. 307.  77. 191. 126.  74.  33.  62.]
 [ 53.  24. 124.  72. 368.  57. 128. 125.  30.  19.]
 [ 22.  25.  66. 201.  97. 347.  85.  98.  41.  18.]
 [  9.  26.  72. 102. 120.  66. 523.  37.  11.  34.]
 [ 31.  24.  38.  79. 120.  76.  30. 515.  25.  62.]
 [ 97.  59.  10.  29.  25.  22.  10.  16. 651.  81.]
 [ 46. 161.  12.  23.  12.  31.  25.  61.  76. 553.]]
Train accuracy: 0.49045 (count 19618 of 40000)
Test accuracy: 0.463 (count 4630 of 10000)

#################################################################

Epoch 1/10, Train loss: 2.35183, Val loss: 2.27046
Epoch 2/10, Train loss: 2.24797, Val loss: 2.23831
Epoch 3/10, Train loss: 2.22979, Val loss: 2.22573
Epoch 4/10, Train loss: 2.22217, Val loss: 2.21949
Epoch 5/10, Train loss: 2.21727, Val loss: 2.21750
Epoch 6/10, Train loss: 2.21590, Val loss: 2.21763
Epoch 7/10, Train loss: 2.21966, Val loss: 2.22088
Epoch 8/10, Train loss: 2.22113, Val loss: 2.22306
Epoch 9/10, Train loss: 2.22448, Val loss: 2.22511
Epoch 10/10, Train loss: 2.22646, Val loss: 2.22730
Setup: {'epochs': 10, 'lr': 0.0001, 'bn': False, 'batch_size': 2, 'hidden_layers': [128, 64, 32, 10], 'activations': [None, 'ReLU', 'ReLU', 'softmax'], 'input_size': 128, 'weight_decay': 0, 'optimiser': None}

Confusion matrix for train data:
[[1.718e+03 8.800e+01 0.000e+00 2.000e+00 5.230e+02 0.000e+00 1.570e+02
  7.000e+00 1.155e+03 3.440e+02]
 [3.040e+02 2.230e+02 0.000e+00 3.000e+00 1.068e+03 0.000e+00 5.810e+02
  1.500e+01 8.890e+02 9.200e+02]
 [8.550e+02 1.220e+02 2.000e+00 3.000e+00 1.688e+03 0.000e+00 7.060e+02
  2.300e+01 2.940e+02 2.880e+02]
 [5.980e+02 1.160e+02 2.000e+00 8.000e+00 1.627e+03 6.000e+00 9.760e+02
  4.800e+01 2.410e+02 3.860e+02]
 [3.610e+02 9.100e+01 2.000e+00 3.000e+00 2.122e+03 0.000e+00 8.530e+02
  2.800e+01 2.980e+02 2.480e+02]
 [5.780e+02 1.210e+02 5.000e+00 9.000e+00 1.929e+03 1.300e+01 7.910e+02
  4.300e+01 2.170e+02 2.730e+02]
 [3.720e+02 1.240e+02 1.000e+00 1.700e+01 1.588e+03 0.000e+00 1.529e+03
  3.000e+01 1.080e+02 2.520e+02]
 [4.450e+02 1.060e+02 3.000e+00 5.000e+00 1.855e+03 0.000e+00 4.480e+02
  8.800e+01 4.210e+02 6.430e+02]
 [5.560e+02 1.000e+02 1.000e+00 1.000e+00 5.310e+02 1.000e+00 1.120e+02
  4.000e+00 2.178e+03 4.570e+02]
 [2.990e+02 1.650e+02 0.000e+00 3.000e+00 5.360e+02 1.000e+00 2.430e+02
  2.600e+01 1.410e+03 1.370e+03]]

Confusion matrix for test data:
[[470.  25.   1.   0. 134.   0.  26.   1. 277.  66.]
 [ 93.  61.   0.   0. 248.   0. 154.   4. 225. 215.]
 [228.  41.   1.   1. 420.   0. 169.   9.  80.  51.]
 [130.  40.   2.   1. 424.   0. 236.   8.  73.  86.]
 [ 94.  28.   0.   1. 507.   0. 233.  11.  61.  65.]
 [159.  22.   1.   4. 504.   2. 173.   9.  66.  60.]
 [ 95.  31.   0.   2. 392.   0. 378.   9.  25.  68.]
 [127.  30.   0.   1. 412.   0. 104.  22. 115. 189.]
 [122.  25.   0.   0. 130.   0.  29.   1. 564. 129.]
 [ 85.  46.   0.   2. 137.   0.  53.   4. 362. 311.]]
Train accuracy: 0.231275 (count 9251 of 40000)
Test accuracy: 0.2317 (count 2317 of 10000)

#################################################################
Didnt replicate a previous result when it should have

Epoch 1/20, Train loss: 1.81748, Val loss: 1.72991
Epoch 2/20, Train loss: 1.63191, Val loss: 1.64591
Epoch 3/20, Train loss: 1.55719, Val loss: 1.61947
Epoch 4/20, Train loss: 1.51513, Val loss: 1.60014
Epoch 5/20, Train loss: 1.47843, Val loss: 1.58756
Epoch 6/20, Train loss: 1.46456, Val loss: 1.59937
Epoch 7/20, Train loss: 1.44784, Val loss: 1.58775
Epoch 8/20, Train loss: 1.42833, Val loss: 1.56928
Epoch 9/20, Train loss: 1.42178, Val loss: 1.57540
Epoch 10/20, Train loss: 1.41558, Val loss: 1.57478
Epoch 11/20, Train loss: 1.40257, Val loss: 1.59957
Epoch 12/20, Train loss: 1.39418, Val loss: 1.62314
Epoch 13/20, Train loss: 1.39841, Val loss: 1.61211
Epoch 14/20, Train loss: 1.38870, Val loss: 1.60740
Epoch 15/20, Train loss: 1.37218, Val loss: 1.61019
Epoch 16/20, Train loss: 1.38663, Val loss: 1.60848
Epoch 17/20, Train loss: 1.36463, Val loss: 1.61260
Epoch 18/20, Train loss: 1.37669, Val loss: 1.59503
Epoch 19/20, Train loss: 1.36414, Val loss: 1.59275
Epoch 20/20, Train loss: 1.36956, Val loss: 1.62093
Setup: {'epochs': 20, 'lr': 0.001, 'bn': False, 'batch_size': 2, 'hidden_layers': [128, 64, 32, 10], 'activations': [None, 'ReLU', 'ReLU', 'softmax'], 'input_size': 128, 'weight_decay': 0, 'optimiser': 'Adam'}

Confusion matrix for train data:
[[2247.  231.  177.  142.  228.   66.   46.  103.  516.  238.]
 [ 160. 2829.   11.  129.   60.   22.   65.   27.  191.  509.]
 [ 298.   86.  946.  519. 1097.  364.  298.  211.   92.   70.]
 [ 101.  128.  182. 1818.  225.  818.  392.  145.   92.  107.]
 [ 235.   87.  238.  313. 2119.  237.  284.  345.   85.   63.]
 [  66.   76.  168. 1347.  236. 1563.  199.  200.   62.   62.]
 [  45.   88.  175.  549.  637.  200. 2183.   53.   43.   48.]
 [ 116.   75.   91.  362.  375.  419.   73. 2312.   35.  156.]
 [ 449.  287.   35.  174.   88.   58.   17.   14. 2631.  188.]
 [ 150.  849.   31.  244.   49.   67.   55.  141.  195. 2272.]]

Confusion matrix for test data:
[[504.  47.  55.  39.  68.  15.  20.  27. 161.  64.]
 [ 36. 636.   8.  54.  20.  10.  26.  15.  51. 144.]
 [100.  24. 205. 127. 238. 107.  88.  63.  26.  22.]
 [ 25.  31.  49. 393.  91. 203.  92.  53.  25.  38.]
 [ 57.  23.  77.  85. 472.  72. 103.  82.  16.  13.]
 [ 26.  21.  64. 312.  79. 334.  61.  59.  28.  16.]
 [ 15.  37.  48. 142. 172.  59. 476.  22.  14.  15.]
 [ 40.  22.  40. 108. 113. 106.  25. 474.  15.  57.]
 [140.  88.   8.  45.  25.  20.   9.  10. 591.  64.]
 [ 55. 232.   7.  69.  12.  27.  18.  43.  60. 477.]]
Train accuracy: 0.523 (count 20920 of 40000)
Test accuracy: 0.4562 (count 4562 of 10000)

Key observations -
- Adams optimisers likes a much lower learning rate (0.0001) !! - Need to also check with seb that it is implemented correctly, ends up getting a good validation loss. Needed to have the optimiser made for each hidden layer.
- Issues, not replicating Seb's results! May have stuffed up the updates